import csv
import json
import pandas as pd 
import sys, getopt, pprint
from pymongo import MongoClient

uri = 'mongodb://user:password1@ds159025.mlab.com:59025/ri_crime_data'

client = MongoClient(uri)

db = client.get_database()
db_cases = db['cases']
db_arrests = db['arrests']

case_data = pd.read_csv("./PPCL_180days.csv")
arrest_data = pd.read_csv("./PPAL_60days.csv")

case_json = json.loads(case_data.to_json(orient='records'))
arrest_json = json.loads(arrest_data.to_json(orient='records'))

all = db_cases.find({})

pairs = [39.950265,-75.16368499999999,
41.8095832,-71.43612840000003,
37.029961,-76.3502029,
41.8058941,-71.43931220000002,
41.8527612,-71.43528879999997,
41.0258234,-81.72073019999999,
41.0258234,-81.72073019999999,
40.80366799999999,-74.19516369999997,
41.824537,-71.412237,
41.841278,-71.42934600000001,
37.02919,-76.34260599999999,
42.465647,-71.1418112,
42.0924341,-72.5804412,
41.8196833,-71.4235362,
41.6724964,-72.79371909999998,
41.8166725,-71.4210162,
41.8259146,-71.43646710000002,
41.54483279999999,-73.04885209999998,
43.6506949,-79.38232419999997,
35.5635914,-82.5397921,
42.6689447,-73.77305509999997,
42.9269705,-72.2809502,
41.8047994,-71.43670350000002,
41.8446514,-71.3969596,
41.818926,-71.4593979,
40.7138294,-74.00784859999999,
42.392865,-71.03455400000001,
32.7660527,-97.46454870000002,
40.718186,-74.00240680000002,
41.8239722,-71.41180029999998,
39.8611717,-75.0033378,
37.6911641,-97.33899639999998,
41.8166725,-71.4210162,
41.8208062,-71.43383019999999,
41.7996465,-71.4072534,
34.3241107,-89.95843159999998,
41.0728342,-73.52414279999999,
34.7381435,-87.70383470000002,
40.7414615,-74.2235498,
41.81642069999999,-71.44416530000001,
41.531808,-75.647919,
41.5801839,-71.24642369999998,
41.8139153,-71.44843200000003,
41.8174722,-71.41783029999999,
40.7546608,-74.15259939999999,
40.7245296,-74.17901979999999,
41.8377582,-71.41483579999999,
39.7919455,-76.73648880000002,
41.827286,-71.41598599999998,
37.7133619,-122.4608111,
41.63173140000001,-70.93447930000002,
38.2494303,-104.65356689999999,
41.8196128,-71.39600630000001,
41.8287939,-71.46182859999999,
43.0849626,-76.87935570000002,
40.8409025,-74.18106080000001,
41.8068304,-71.44754940000001,
27.9595276,-82.50667629999998,
41.819448,-71.463302,
41.8197292,-71.42036940000003,
40.691216,-73.96681799999999,
35.4939851,-77.03762360000002,
41.8079616,-71.4351145,
25.7697123,-80.13478959999998,
41.8197292,-71.42036940000003,
41.8250314,-71.43972300000001,
41.8212266,-71.43045110000003,
41.8244829,-71.43635979999999,
41.7947186,-71.41502400000002,
41.8193291,-71.44272719999998,
41.8092703,-71.43087530000003,
32.7761418,-79.93713029999998,
41.0728342,-73.52414279999999,
41.8251262,-71.41713449999997,
42.7149819,-73.9407397,
41.8503204,-71.41339849999997,
42.9758588,-71.4598335,
41.8095015,-71.43940359999999,
42.39748729999999,-71.57654489999999,
39.700199,-75.012159,
32.4139648,-93.76283339999998,
40.7139714,-74.0078115,
41.7863908,-71.39933780000001,
43.6506949,-79.38232419999997,
41.8248626,-71.45312130000002,
41.8244829,-71.43635979999999,
41.8472503,-71.4339948,
42.73220449999999,-71.08102209999998,
41.8197292,-71.42036940000003,
41.827172,-71.38095190000001,
41.8467231,-71.43033439999999,
41.8248283,-71.39361300000002,
41.8157579,-71.44264190000001,
42.7055885,-71.13612189999998,
41.18054559999999,-73.20739779999997,
41.8153108,-71.44956109999998,
41.8021016,-71.42182730000002,
41.8113917,-71.41112420000002,
25.7697123,-80.13478959999998,
41.8378615,-71.4449775,
44.0287398,-70.10877270000003,
39.9272138,-122.167598,
41.8452736,-71.4119394,
41.853687,-71.43786599999999,
41.8419063,-71.4377121,
41.6584542,-70.2757575,
40.8241549,-74.18893249999996,
41.824537,-71.412237,
41.8171825,-71.4257801,
32.3531499,-90.15338070000001,
41.799592,-71.40597480000002,
41.799592,-71.40597480000002,
42.3022105,-71.0718905,
41.8232206,-71.4465927,
40.687177,-73.9909351,
41.82106719999999,-71.4119609,
38.8270132,-76.9123242,
41.853475,-71.44433099999998,
41.8441035,-71.43796050000003,
37.3856044,-93.95327050000003,
41.816389,-71.42206039999996,
45.520576,-122.65995290000001,
40.697168,-73.61349109999998,
40.2405458,-74.7120385,
39.700199,-75.012159,
41.2343407,-74.01601169999998,
41.8182487,-71.41306099999997,
41.8377582,-71.41483579999999,
41.8113917,-71.41112420000002,
25.7697123,-80.13478959999998,
41.78865589999999,-71.43160869999997,
35.5533001,-77.0589842,
41.8374645,-71.38980219999996,
41.844888,-71.41672219999998,
41.8278238,-71.4162068,
41.8171825,-71.4257801,
41.7853636,-71.42057039999997,
40.725623,-73.94717600000001,
40.735214,-74.2258425,
41.8285107,-71.45647789999998,
41.82300800000001,-71.45752099999999,
41.80299300000001,-71.4189101,
41.8072599,-71.4327725,
41.79327929999999,-71.40686019999998,
41.807369,-71.43804599999999,
41.807939,-71.43910900000003,
41.8072599,-71.4327725,
41.8213026,-71.42627900000002,
41.8160037,-71.44052119999998,
41.0728342,-73.52414279999999,
41.80522939999999,-71.43728799999997,
41.8072599,-71.4327725,
41.2662616,-73.221359,
37.928579,-122.3887226,
40.80366799999999,-74.19516369999997,
40.0361628,-86.89873439999997,
37.67475880000001,-95.46580549999999,
41.853687,-71.43786599999999,
41.8046069,-71.41986829999996,
47.6290022,-122.12999930000001,
42.4708866,-70.9255384,
41.798177,-71.406878,
41.0728342,-73.52414279999999,
42.2378317,-71.00126219999999,
41.8216448,-71.42336790000002,
41.809996,-71.44903390000002,
39.4843264,-106.0463684,
41.8094093,-71.42213349999997,
41.822462,-71.45024339999998,
41.8251243,-71.44634589999998,
41.7869491,-71.43248740000001,
41.852652,-71.4175773,
40.577414,-73.961161,
38.907126,-104.78486099999998,
41.8523343,-71.42747810000003,
41.3959887,-73.4692359,
41.815681,-71.4580919,
41.8471502,-71.41766789999997,
42.2374571,-71.00332229999998,
40.691216,-73.96681799999999,
38.4192496,-82.445154,
41.8035437,-71.4277045,
42.5489207,-83.2144386,
41.835831,-71.4172969,
41.8351104,-71.42229680000003,
41.844888,-71.41672219999998,
32.7872708,-79.98878259999998,
39.5245404,-119.8092747,
35.61774630000001,-117.65038290000001,
41.8281299,-71.44158479999999,
41.82716800000001,-71.43464419999998,
42.4144772,-71.04000339999999,
42.262917,-71.09667150000001,
40.3524645,-76.20522829999999,
34.8957957,-117.01728259999999,
41.8282232,-71.4619394,
41.8168703,-71.41436620000002,
41.8450743,-71.4262511,
29.4269057,-98.49287979999997,
41.8192695,-71.44070060000001,
41.823318,-71.39794899999998,
34.9442803,-81.91071169999998,
41.8082485,-71.43509230000001,
40.7460662,-73.22587499999997,
41.828245,-71.451704,
39.7190985,-105.09053979999999,
41.8146688,-71.44652839999998,
41.8158821,-71.44542290000004,
41.1900809,-73.1257172,
42.3480769,-71.21117079999999,
41.8277606,-71.41182549999996,
41.839523,-71.45277099999998,
41.810193,-71.42594680000002,
41.8240588,-71.4511094,
42.3607534,-71.20609509999997,
41.8518169,-71.42982,
41.8168796,-71.4112379,
41.8219222,-71.4319959,
41.821349,-71.41577970000003,
41.8072209,-71.44943839999996,
41.8174306,-71.42091590000001,
43.125648,-77.61210699999998,
41.8166725,-71.4210162,
41.810464,-71.44391200000001,
41.8515249,-71.4228521,
41.833148,-71.42527489999998,
41.837444,-71.43212699999998,
49.226538,-123.125587,
41.823027,-71.41034769999999,
41.8103278,-71.40816819999998,
37.6998285,-113.06653790000001,
39.954275,-76.75074799999999,
41.8233016,-71.42430079999997,
42.3388685,-71.2527116,
41.8178649,-71.46784059999999,
42.4629061,-73.23278720000002,
41.8358913,-71.41370979999999,
25.7697123,-80.13478959999998,
40.9737787,-72.16260039999997,
39.7196263,-104.93306760000002,
41.8038411,-71.43297080000002,
41.8214075,-71.40948100000003,
33.7617504,-84.42697820000001,
41.82404880000001,-71.43540949999999,
40.7326405,-73.95300279999998,
40.6658578,-73.6384208,
41.8291785,-71.39310899999998,
41.8197581,-71.44202410000003,
41.8259274,-71.4571388,
41.8945168,-87.62710809999999,
41.797605,-71.414286,
34.7381435,-87.70383470000002,
41.8406654,-71.39347069999997,
44.477946,-73.2012274,
41.8346576,-71.40275509999998,
41.8467231,-71.43033439999999,
41.850834,-71.42276500000003,
41.816903,-71.45733589999998,
41.823027,-71.41034769999999,
41.81596529999999,-71.40875549999998,
41.83614439999999,-71.4343427,
41.848094,-71.39612469999997,
41.80288410000001,-71.41096529999999,
41.8403654,-71.4425923,
41.799313,-71.428112,
41.8183883,-71.4259993,
42.3444751,-71.05721240000003,
40.6660175,-73.66542570000001,
41.8127755,-71.42386620000002,
41.8253676,-71.45625760000001,
41.8023814,-71.42607320000002,
40.665975,-73.40298810000002,
39.8968984,-79.71263220000003,
41.8177616,-71.44542790000003,
41.8323179,-71.3197376,
36.84908480000001,-76.335711,
41.793804,-71.45530689999998,
41.8192499,-71.42278299999998,
41.8349427,-71.43366930000002,
41.8319787,-71.4345879,
42.91752,-78.87744900000001,
41.81464800000001,-71.42754200000002,
41.8351848,-71.43559210000001,
32.7995355,-79.95072520000002,
41.8208062,-71.43383019999999,
41.8012929,-71.4014252,
41.8550549,-71.44090360000001,
41.8244829,-71.43635979999999,
40.8122694,-74.22299959999998,
41.63173140000001,-70.93447930000002,
42.1330331,-80.09226180000002,
42.6961342,-71.1383763,
41.7953586,-71.4300025,
41.8228235,-71.44415240000001,
41.812602,-71.42941780000001,
41.8197292,-71.42036940000003,
27.9595276,-82.50667629999998,
41.78798949999999,-71.4211699,
43.0496185,-75.88518770000002,
41.0728342,-73.52414279999999,
40.5991891,-74.32557550000001,
40.5991891,-74.32557550000001,
43.0760513,-89.39504199999999,
41.8229147,-71.42513989999998,
41.8468471,-71.42281659999998,
41.844888,-71.41672219999998,
41.8040663,-72.70289259999998,
41.8040663,-72.70289259999998,
41.804824,-71.42943689999998,
40.8368292,-74.0902489,
41.8213026,-71.42627900000002,
41.828897,-71.41591299999999,
40.7168473,-73.99990259999998,
41.7894579,-71.42047489999999,
41.8276277,-71.39467200000001,
41.826596,-71.43476520000002,
39.0884867,-77.1396856,
40.3954967,-74.63932009999996,
41.9006421,-87.9397308,
41.7980365,-71.41757519999999,
41.813396,-71.43172500000003,
41.8128733,-71.45399659999998,
41.8125925,-71.4519353,
40.3380896,-75.91969119999999,
40.5866253,-75.4546598,
41.8021625,-71.41664750000001,
42.0816458,-70.9809057,
41.8316913,-71.44410949999997,
42.6570937,-71.30377220000003,
41.8450718,-71.42341950000002,
41.8169108,-71.41671710000003]